services:
  # Main Web Service
  - type: web
    name: agripal-app
    env: python
    region: singapore  # Change to your preferred region
    plan: free  # Options: free, starter ($7/mo), standard ($25/mo)
    buildCommand: pip install -r requirements.txt
    startCommand: gunicorn app:app --workers 2 --threads 4 --timeout 120 --bind 0.0.0.0:$PORT
    healthCheckPath: /health
    
    envVars:
      # Python Configuration
      - key: PYTHON_VERSION
        value: 3.11.0
      
      # Flask Configuration
      - key: FLASK_ENV
        value: production
      
      - key: SECRET_KEY
        generateValue: true  # Render will auto-generate a secure key
      
      # API Keys (Set these manually in Render dashboard)
      - key: GEMINI_API_KEY
        sync: false  # Must be set manually
      
      # Database URL (if using PostgreSQL)
      - key: DATABASE_URL
        fromDatabase:
          name: agripal-db
          property: connectionString
    
    autoDeploy: true  # Auto-deploy on git push

# Optional: PostgreSQL Database (Recommended for production)
# Uncomment this section if you want to use PostgreSQL instead of SQLite
#
# databases:
#   - name: agripal-db
#     databaseName: agripal
#     user: agripal_user
#     plan: free  # Free tier: 90 days, then $7/month
